name: Deploy MkDocs to GitHub Pages

on:
  push:
    branches:
      - main
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: pages
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'
      
      - name: Install MkDocs
        run: |
          pip install mkdocs mkdocs-material pymdown-extensions mkdocs-minify-plugin
      
      - name: Build site
        run: |
          mkdir -p build/docs
          
          for dir in 00_* 01_* 02_* 03_* 04_* 05_* 06_* 07_* 08_* 09_* 10_* 11_* 12_* 13_* 14_* 15_* 16_* 17_* 18_* 19_* 20_* Exercises Projects Resources; do
            if [ -d "$dir" ]; then
              cp -r "$dir" build/docs/
            fi
          done
          
          cp *.md build/docs/ 2>/dev/null || true
          
          mkdir -p build/docs/stylesheets
          
          cat > build/docs/stylesheets/extra.css << 'CSSEOF'
          /* VibeLearning - Catppuccin Mocha Theme */
          
          :root {
            --md-text-font: "Inter";
            --md-code-font: "Fira Code";
            --md-typeset-line-height: 1.75;
            --md-typeset-font-size: 0.95rem;
          }
          
          /* Catppuccin Mocha Dark Mode */
          [data-md-color-scheme="slate"] {
            --md-primary-fg-color: #b4befe;
            --md-primary-fg-color--light: #cba6f7;
            --md-primary-fg-color--dark: #9399b2;
            --md-accent-fg-color: #89b4fa;
            --md-accent-fg-color--transparent: rgba(137, 180, 250, 0.15);
            --md-typeset-color: #cdd6f4;
            --md-typeset-a-color: #89b4fa;
            --md-default-bg-color: #1e1e2e;
            --md-default-bg-color--light: #313244;
            --md-default-bg-color--lighter: #45475a;
            --md-default-bg-color--lightest: #585b70;
            --md-code-bg-color: #181825;
            --md-code-fg-color: #cdd6f4;
          }
          
          /* Headings with Catppuccin colors */
          [data-md-color-scheme="slate"] .md-typeset h1 {
            font-weight: 700;
            font-size: 2.4em;
            background: linear-gradient(135deg, #cba6f7 0%, #89b4fa 50%, #94e2d5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            border-bottom: 2px solid rgba(203, 166, 247, 0.2);
            padding-bottom: 0.3em;
            margin-bottom: 0.8em;
          }
          
          [data-md-color-scheme="slate"] .md-typeset h2 {
            font-weight: 600;
            font-size: 1.6em;
            color: #b4befe;
            margin-top: 1.8em;
            margin-bottom: 0.6em;
          }
          
          [data-md-color-scheme="slate"] .md-typeset h3 {
            font-weight: 600;
            font-size: 1.3em;
            color: #f5c2e7;
            margin-top: 1.5em;
          }
          
          [data-md-color-scheme="slate"] .md-typeset h4 {
            font-weight: 600;
            font-size: 1.1em;
            color: #f9e2af;
          }
          
          /* Links */
          [data-md-color-scheme="slate"] .md-typeset a {
            color: #89b4fa;
            font-weight: 500;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: all 0.2s ease;
          }
          
          [data-md-color-scheme="slate"] .md-typeset a:hover {
            color: #b4befe;
            border-bottom-color: #b4befe;
          }
          
          /* Code styling */
          [data-md-color-scheme="slate"] .md-typeset code {
            font-family: "Fira Code", monospace;
            font-size: 0.85em;
            color: #f5c2e7;
            background-color: rgba(245, 194, 231, 0.1);
            border: 1px solid rgba(245, 194, 231, 0.2);
            border-radius: 6px;
            padding: 0.2em 0.4em;
          }
          
          [data-md-color-scheme="slate"] .md-typeset pre {
            background-color: #181825;
            border-radius: 10px;
            border: 1px solid #313244;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
          }
          
          [data-md-color-scheme="slate"] .md-typeset pre > code {
            background: transparent;
            border: none;
            color: #cdd6f4;
          }
          
          /* Code block filename */
          [data-md-color-scheme="slate"] .md-typeset .highlight .filename {
            background: linear-gradient(90deg, #cba6f7 0%, #b4befe 100%);
            color: #1e1e2e;
            font-weight: 600;
            border-radius: 10px 10px 0 0;
            padding: 0.5em 1em;
          }
          
          /* Admonitions - Catppuccin colors */
          [data-md-color-scheme="slate"] .md-typeset .admonition {
            border-radius: 10px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
          }
          
          [data-md-color-scheme="slate"] .md-typeset .admonition.tip {
            border-left-color: #a6e3a1;
          }
          [data-md-color-scheme="slate"] .md-typeset .admonition.tip > .admonition-title {
            background-color: rgba(166, 227, 161, 0.1);
            color: #a6e3a1;
          }
          
          [data-md-color-scheme="slate"] .md-typeset .admonition.note {
            border-left-color: #89b4fa;
          }
          [data-md-color-scheme="slate"] .md-typeset .admonition.note > .admonition-title {
            background-color: rgba(137, 180, 250, 0.1);
            color: #89b4fa;
          }
          
          [data-md-color-scheme="slate"] .md-typeset .admonition.warning {
            border-left-color: #f9e2af;
          }
          [data-md-color-scheme="slate"] .md-typeset .admonition.warning > .admonition-title {
            background-color: rgba(249, 226, 175, 0.1);
            color: #f9e2af;
          }
          
          [data-md-color-scheme="slate"] .md-typeset .admonition.danger {
            border-left-color: #f38ba8;
          }
          [data-md-color-scheme="slate"] .md-typeset .admonition.danger > .admonition-title {
            background-color: rgba(243, 139, 168, 0.1);
            color: #f38ba8;
          }
          
          /* Tables */
          [data-md-color-scheme="slate"] .md-typeset table {
            border-radius: 10px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            border: 1px solid #313244;
          }
          
          [data-md-color-scheme="slate"] .md-typeset table thead {
            background: linear-gradient(90deg, #cba6f7 0%, #b4befe 100%);
          }
          
          [data-md-color-scheme="slate"] .md-typeset table th {
            color: #1e1e2e;
            font-weight: 600;
          }
          
          [data-md-color-scheme="slate"] .md-typeset table td {
            border-bottom-color: #313244;
          }
          
          [data-md-color-scheme="slate"] .md-typeset table tbody tr:nth-child(even) {
            background-color: #181825;
          }
          
          /* Header */
          [data-md-color-scheme="slate"] .md-header {
            background: linear-gradient(90deg, #181825 0%, #1e1e2e 100%);
            border-bottom: 1px solid #313244;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
          }
          
          [data-md-color-scheme="slate"] .md-header__title {
            color: #cdd6f4;
          }
          
          /* Tabs */
          [data-md-color-scheme="slate"] .md-tabs {
            background-color: #11111b;
            border-bottom: 1px solid #313244;
          }
          
          [data-md-color-scheme="slate"] .md-tabs__link {
            color: #a6adc8;
          }
          
          [data-md-color-scheme="slate"] .md-tabs__link:hover {
            color: #b4befe;
          }
          
          [data-md-color-scheme="slate"] .md-tabs__link--active {
            color: #cba6f7;
            font-weight: 600;
          }
          
          /* Navigation sidebar */
          [data-md-color-scheme="slate"] .md-nav__link {
            color: #a6adc8;
            border-radius: 6px;
            padding: 0.4em 0.8em;
          }
          
          [data-md-color-scheme="slate"] .md-nav__link:hover {
            background-color: rgba(180, 190, 254, 0.1);
            color: #b4befe;
          }
          
          [data-md-color-scheme="slate"] .md-nav__link--active {
            color: #cba6f7;
            background-color: rgba(203, 166, 247, 0.1);
            font-weight: 600;
          }
          
          [data-md-color-scheme="slate"] .md-nav__item--section > .md-nav__link {
            color: #f5c2e7;
            text-transform: uppercase;
            font-size: 0.9em;
            letter-spacing: 0.05em;
          }
          
          /* Search */
          [data-md-color-scheme="slate"] .md-search__input {
            background-color: #313244;
            border: 1px solid #45475a;
            color: #cdd6f4;
            border-radius: 8px;
          }
          
          [data-md-color-scheme="slate"] .md-search__input::placeholder {
            color: #6c7086;
          }
          
          /* Blockquotes */
          [data-md-color-scheme="slate"] .md-typeset blockquote {
            border-left: 4px solid #cba6f7;
            background: linear-gradient(90deg, rgba(203, 166, 247, 0.1) 0%, transparent 100%);
            border-radius: 0 10px 10px 0;
            padding: 1em 1.2em;
          }
          
          /* HR */
          [data-md-color-scheme="slate"] .md-typeset hr {
            background: linear-gradient(90deg, transparent 0%, #45475a 20%, #585b70 50%, #45475a 80%, transparent 100%);
            height: 2px;
            border: none;
          }
          
          /* Footer */
          [data-md-color-scheme="slate"] .md-footer {
            background-color: #181825;
            border-top: 1px solid #313244;
          }
          
          /* Back to top button */
          [data-md-color-scheme="slate"] .md-top {
            background: linear-gradient(135deg, #cba6f7 0%, #89b4fa 100%);
            color: #1e1e2e;
          }
          
          /* Home page hero gradient */
          [data-md-color-scheme="slate"] .md-content__inner > h1:first-child {
            text-align: center;
            font-size: 2.8em;
            background: linear-gradient(135deg, #cba6f7 0%, #89b4fa 30%, #94e2d5 60%, #f5c2e7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
          }
          
          /* Scrollbar */
          [data-md-color-scheme="slate"] ::-webkit-scrollbar {
            width: 10px;
          }
          [data-md-color-scheme="slate"] ::-webkit-scrollbar-track {
            background: #181825;
          }
          [data-md-color-scheme="slate"] ::-webkit-scrollbar-thumb {
            background: #45475a;
            border-radius: 5px;
          }
          [data-md-color-scheme="slate"] ::-webkit-scrollbar-thumb:hover {
            background: #585b70;
          }
          
          /* Selection */
          [data-md-color-scheme="slate"] ::selection {
            background-color: rgba(203, 166, 247, 0.3);
            color: #cdd6f4;
          }
          CSSEOF
          
          cat > build/mkdocs.yml << 'EOF'
          site_name: VibeLearning
          site_description: A comprehensive Python learning resource
          site_url: https://jackc0re.github.io/VibeLearning/
          docs_dir: docs
          site_dir: site
          
          theme:
            name: material
            
            # Custom Fonts - Inter for text, Fira Code for code
            font:
              text: Inter
              code: Fira Code
            
            # Color Palette - Catppuccin Mocha
            palette:
              # Dark mode (default - Catppuccin Mocha)
              - scheme: slate
                primary: custom
                accent: custom
                toggle:
                  icon: material/brightness-4
                  name: Switch to light mode
              # Light mode (Catppuccin Latte)
              - scheme: default
                primary: custom
                accent: custom
                toggle:
                  icon: material/brightness-7
                  name: Switch to dark mode
            
            # Enhanced features
            features:
              # Top navigation tabs for main sections
              - navigation.tabs
              - navigation.tabs.sticky
              # Collapse sidebar sections by default  
              - navigation.sections
              # Auto-collapse other sections when one opens
              - navigation.collapse
              # Search enhancements
              - search.suggest
              - search.highlight
              - search.share
              # Code block features
              - content.code.copy
              - content.code.annotate
              - content.action.edit
              # Content features
              - content.tooltips
              - content.tabs.link
              # Navigation
              - navigation.top
              - navigation.footer
              
          # Custom CSS
          extra_css:
            - stylesheets/extra.css
          
          plugins:
            - search
            - minify:
                minify_html: true
          
          markdown_extensions:
            - pymdownx.highlight:
                anchor_linenums: true
                line_spans: __span
                pygments_lang_class: true
            - pymdownx.superfences:
                custom_fences:
                  - name: mermaid
                    class: mermaid
                    format: !!python/name:pymdownx.superfences.fence_code_format
            - pymdownx.inlinehilite
            - pymdownx.snippets
            - tables
            - toc:
                permalink: true
                title: On this page
            - admonition
            - pymdownx.details
            - pymdownx.tabbed:
                alternate_style: true
            - attr_list
            - md_in_html
            - pymdownx.emoji:
                emoji_index: !!python/name:material.extensions.emoji.twemoji
                emoji_generator: !!python/name:material.extensions.emoji.to_svg
            - pymdownx.tasklist:
                custom_checkbox: true
          
          nav:
            - Home: README.md
            - Getting Started:
              - Overview: 00_getting_started/README.md
              - Python Setup: 00_getting_started/01_python_setup.md
              - Running Code: 00_getting_started/02_running_code.md
              - Using This Repo: 00_getting_started/03_using_this_repo.md
            - Core Fundamentals:
              - Foundations: 01_foundations/README.md
              - Variables & Types: 01_foundations/01_variables_and_types/README.md
              - Operators: 01_foundations/02_operators/README.md
              - Control Flow: 01_foundations/03_control_flow/README.md
              - Loops: 01_foundations/04_loops/README.md
              - Functions: 01_foundations/05_functions_basics/README.md
              - Input/Output: 01_foundations/06_input_output/README.md
              - Data Structures Overview: 02_data_structures/README.md
              - Lists & Arrays: 02_data_structures/01_lists_arrays/README.md
              - Strings: 02_data_structures/02_strings/README.md
              - Dictionaries: 02_data_structures/03_dictionaries_maps/README.md
              - Sets: 02_data_structures/04_sets/README.md
              - Tuples: 02_data_structures/05_tuples/README.md
              - Stacks & Queues: 02_data_structures/06_stacks_queues/README.md
              - Linked Lists: 02_data_structures/07_linked_lists/README.md
              - Trees: 02_data_structures/08_trees/README.md
              - Graphs: 02_data_structures/09_graphs/README.md
              - Hash Tables: 02_data_structures/10_hash_tables/README.md
            - Advanced Concepts:
              - Algorithms: 03_algorithms/README.md
              - OOP Concepts: 04_oop_concepts/README.md
              - Functional Programming: 05_functional_programming/README.md
              - Software Design: 06_software_design/README.md
              - Design Patterns: 07_design_patterns/README.md
              - CS Fundamentals: 17_cs_fundamentals/README.md
            - Production Ready:
              - Error Handling: 08_error_handling/README.md
              - Testing: 09_testing/README.md
              - Debugging: 14_debugging/README.md
              - Version Control: 15_version_control/README.md
              - File I/O: 10_file_io/README.md
              - Memory & Performance: 11_memory_performance/README.md
              - Concurrency: 12_concurrency/README.md
              - Modules & Packages: 13_modules_packages/README.md
            - Real World:
              - Essential Libraries: 16_essential_libraries/README.md
              - Working with APIs: 18_working_with_apis/README.md
              - Data Processing: 19_data_processing/README.md
              - Web Basics: 20_web_basics/README.md
              - Glossary: Resources/glossary.md
          EOF
          
          cd build
          mkdocs build
          mv site ../_site
      
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./_site

  deploy:
    needs: build
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
